<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para Karime ðŸ’–</title>

<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Cormorant+Garamond:wght@400;500&display=swap" rel="stylesheet">

<style>

body{
    margin:0;
    padding:0;
    background:black;
    overflow:hidden;
    font-family:'Cormorant Garamond', serif;
    color:white;
}

/* ===============================
   TRANSICIONES
================================= */

.fadeOut{
    animation:fadeOut 1s forwards;
}
@keyframes fadeOut{
    to{opacity:0;transform:scale(0.95);}
}

h1{
    font-family:'Great Vibes', cursive;
    font-size:52px;
    letter-spacing:2px;
    text-shadow:0 0 20px rgba(255,77,166,0.8);
}

#inicio{
    position:fixed;
    top:50%;
    left:50%;
    transform:translate(-50%,-50%);
    text-align:center;
    width:90%;
}

.botones{
    margin-top:30px;
    display:flex;
    justify-content:center;
    gap:20px;
    flex-wrap:wrap;
}

button{
    padding:12px 28px;
    border:none;
    border-radius:30px;
    font-size:18px;
    cursor:pointer;
    min-width:180px;
    font-family:'Cormorant Garamond', serif;
}

.si{background:#ff4da6;color:white;}
.no{background:#444;color:white;}

#carta{
    display:none;
    position:fixed;
    top:10vh;
    left:50%;
    transform:translateX(-50%) scale(0.9);
    width:85%;
    max-width:650px;
    max-height:80vh;
    overflow-y:auto;
    text-align:center;
    opacity:0;
    backdrop-filter:blur(6px);
    transition:1.5s;
}

#texto{
    font-size:26px;
    line-height:1.6;
    min-height:150px;
}

#foto{
    width:260px;
    margin-top:20px;
    border-radius:20px;
    opacity:0;
    transition:2s;
}

@keyframes flotar{
    0%{transform:translateY(0) scale(1);opacity:1;}
    100%{transform:translateY(-600px) scale(1.3);opacity:0;}
}

@keyframes parpadear{
    0%{opacity:0;}
    50%{opacity:1;}
    100%{opacity:0;}
}

</style>
</head>
<body>

<div id="inicio">
    <h1>Con cariÃ±o para Karime ðŸ’–</h1>
    <div class="botones">
        <button id="btnSi" class="si">Descubrir sorpresa</button>
        <button id="btnNo" class="no">No</button>
    </div>
</div>

<canvas id="canvas" style="display:none;"></canvas>

<div id="carta">
    <div id="texto"></div>
    <img id="foto" src="foto.PNG">
</div>

<audio id="buh" src="buh.mp3"></audio>
<audio id="musica" src="sorpresa.mp3"></audio>

<script>

/* ===============================
   FONDO ESPACIAL
================================= */

const fondo=document.createElement("canvas");
document.body.appendChild(fondo);
fondo.style.position="fixed";
fondo.style.top=0;
fondo.style.left=0;
fondo.style.zIndex="-1";

const ctxFondo=fondo.getContext("2d");

function resize(){
    fondo.width=window.innerWidth;
    fondo.height=window.innerHeight;
}
resize();
window.addEventListener("resize",resize);

let estrellas=[];
for(let i=0;i<250;i++){
    estrellas.push({
        x:Math.random()*fondo.width,
        y:Math.random()*fondo.height,
        size:Math.random()*2.5,
        speed:Math.random()*0.3+0.05
    });
}

function animarFondo(){
    ctxFondo.clearRect(0,0,fondo.width,fondo.height);
    ctxFondo.fillStyle="white";

    estrellas.forEach(e=>{
        e.y+=e.speed;
        e.x+=e.speed*0.2;
        if(e.y>fondo.height){
            e.y=0;
            e.x=Math.random()*fondo.width;
        }
        ctxFondo.beginPath();
        ctxFondo.arc(e.x,e.y,e.size,0,Math.PI*2);
        ctxFondo.fill();
    });

    requestAnimationFrame(animarFondo);
}
animarFondo();

/* ===============================
   BOTONES CORREGIDOS
================================= */

const btnSi=document.getElementById("btnSi");
const btnNo=document.getElementById("btnNo");
let bloqueado=false;

btnSi.addEventListener("click",function(){

    if(bloqueado) return;
    bloqueado=true;

    btnNo.style.pointerEvents="none";
    btnSi.disabled=true;

    document.getElementById("musica").play().catch(()=>{});
    document.getElementById("inicio").classList.add("fadeOut");

    setTimeout(iniciarConstelacion,1000);
});

btnNo.addEventListener("click",moverNo);
btnNo.addEventListener("touchstart",function(e){
    e.preventDefault();
    moverNo();
});

function moverNo(){
    if(bloqueado) return;

    const margen=20;
    const maxX=window.innerWidth-btnNo.offsetWidth-margen;
    const maxY=window.innerHeight-btnNo.offsetHeight-margen;

    btnNo.style.position="fixed";
    btnNo.style.left=Math.random()*maxX+"px";
    btnNo.style.top=Math.random()*maxY+"px";

    document.getElementById("buh").play().catch(()=>{});
}

/* ===============================
   CARTA (TEXTO NUEVO + FINAL LENTO)
================================= */

function mostrarCarta(){

    const carta=document.getElementById("carta");
    carta.style.display="block";

    setTimeout(()=>{
        carta.style.opacity=1;
        carta.style.transform="translateX(-50%) scale(1)";
    },100);

    const mensaje=`Hola, Karime:

No querÃ­a dejar pasar este 14 de febrero sin decirte algo. Aunque llevamos poco tiempo de conocernos, tengo que confesarte que te has convertido en mi parte favorita del dÃ­a.

Me encanta la forma en la que conectamos y lo mucho que disfruto cada minuto a tu lado. QuizÃ¡s es pronto para muchas cosas, pero es el momento justo para decirte que me encantas y que me hace muy feliz estar conociÃ©ndote.

Â¡Feliz San ValentÃ­n! ðŸ’–`;

    let i=0;
    const textoDiv=document.getElementById("texto");

    const cursor=document.createElement("span");
    cursor.innerHTML="|";
    cursor.style.animation="parpadear 1s infinite";
    textoDiv.appendChild(cursor);

    function escribir(){

        if(i < mensaje.length){

            cursor.remove();
            textoDiv.innerHTML += mensaje.charAt(i);
            textoDiv.appendChild(cursor);

            const parteFinal = "Â¡Feliz San ValentÃ­n! ðŸ’–";
            const inicioFinal = mensaje.indexOf(parteFinal);

            let velocidad = 35;

            if(i >= inicioFinal){
                velocidad = 90;
            }

            i++;
            setTimeout(escribir, velocidad);

        } else {
            cursor.remove();
            document.getElementById("foto").style.opacity = 1;
            lanzarCorazones();
        }
    }

    escribir();
}

</script>
</body>
</html>
